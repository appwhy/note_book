# 题集

[TOC]

---



1-24论述具有五层协议的网络体系结构的要点，包括各层的主要功能。

> 答：综合OSI 和TCP/IP 的优点，采用一种原理体系结构。各层的主要功能：
> 物理层 物理层的任务就是透明地传送比特流。（注意：传递信 息的物理媒体，如双绞
> 线、同轴电缆、光缆等，是在物理层的下面，当做第0层。）物理层还要确定连接电
> 缆插头的定义及连接法。
> 数据链路层 数据链路层的任务是在两个相邻结点间的线路上无差错地传送以帧（frame
> ）为单位的数据。每一帧包括数据和必要的控制信息。
> 网络层 网络层的任务就是要选择合适的路由，使 发送站的运输层所传下来的分组能够
> 正确无误地按照地址找到目的站，并交付给目的站的运输层。
> 运输层 运输层的任务是向上一层的进行通信的两个进程之间提供一个可靠的端到端服务，使它们看不见运输层以下的数据通信的细节。
> 应用层 应用层直接为用户的应用进程提供服务。
>
> 仅仅采用了CRC检验，缺重传机制，数据链路层的传输还不是可靠的传输。

---

3-18试说明10BASE-T中的“10”、“BASE”和“T”所代表的意思。

> 答：10BASE-T中的“10”表示信号在电缆上的传输速率为10MB/s，“BASE”表示电缆上
> 的信号是基带信号，“T”代表双绞线星形网，但10BASE-T的 通信距离稍短，每个站到
> 集线器的距离不超过100m。

---

3-20假定1km长的CSMA/CD网络的数据率为1Gb/s。设信号在网络上的传播速率为200000km/s。求能够使用此协议的最短帧长。

> 答：对于1km电缆，单程传播时间为1/200000=5为微秒，来回路程传播时间为10微秒，
> 为了能够按照CSMA/CD工作，最小帧的发射时间不能小于10微秒，以Gb/s速率工作，10
> 微秒可以发送的比特数等于10*10-6*109=10000,因此，最短帧是10000位或1250 字
> 节长

---

## 传输层

1. 如果TCP往返时间RTT的当前值是30ms，随后确认分别在数据发送后26、 32和24ms到达发送方，那么新的RTT估计值分别为多少？假定加权因子α =0.9。

  > 解答：在TCP协议中，从发出数据到收到确认所需要的时间成为往返传输时间 （round trip time,RTT）,简称为往返时间。由于进程之间的通信需要面对 复杂的通信子网，往返时间是变化的，并且很难把握。为此，TCP协议采用一种适应性重传算法。在适应性重传算法中，RTT是一个加权平均值，其计 算公式如下：RTT=α*Old_RTT+(1-α)*New_RTT，其中，Old_RTT是上一个往返时间估计值，New_RTT是实际测出的前一个样本段的往返时间。α是一个常数加权因子（0≤α<1）。 当确认在数据发送后26ms到达时，Old_RTT=30ms，New_RTT=26ms，所以，RTT=0.9*30+（1-0.9）*26=29.6ms；当确认在数据发送后32ms到达时，Old_RTT=29.6ms，New_RTT=32ms，所以，RTT=0.9*29.6+（1-0.9）*32=29.84ms；当确认在数据发送后24ms到达时，Old_RTT=29.84ms，New_RTT=24ms，所以，RTT=0.9*29.84+（1-0.9）*24=29.256ms；

  

在某个网络中，TPDU的长度最大值为128B，最长生存时间为30s，序列号为 8比特。那么，每条TCP连接所能达到的最大数据传输速率是多少？ 

> 解答：具有相同序列号的TPDU不应该同时在网络中传输。因此，必须保证当序列号循环回来重复使用时，具有相同序列号的TPDU已经从网络中消失。现在已知TPDU的生存时间是30s，序列号的长度为8b，TPDU的最大长度为128B，那么在30s的时间内发送方发送的TPDU数目不能多于28-1=255个。所以，每条TCP连接的最大数据传输速率是255*128*8/30=8704（b/s）。



---

有一个TCP连接，当它的拥塞窗口大小为64个分组大小时超时。假设该线路的往返时间RTT是固定的即为3s。不考虑其他开销，即分组不丢失，该 TCP连接在超时后处于慢启动阶段的时间有多少秒？ 

> 解答：当拥塞窗口为64个分组的大小超时，窗口门限值为64/2即32个分组的大小。此后，进入慢启动阶段，每次RTT时间后拥塞窗口的大小加倍，直至拥塞窗口值等于窗口门限值，并进入线性增长阶段。不妨用W（t）表示时刻t的拥塞窗口大小，这样W(0)=1,W(RTT)=2, W(2RTT)=4, W(3RTT)=8,  W(4RTT)=16, W(5RTT)=32。因此，该TCP连接子在超时后重新处于慢启动阶段的时间为5个RTT，即5*3=15s。*



--


假设需要设计一个类似于TCP的滑动窗口协议，该协议将运行于一个 100Mb/s网络上，网络中线路的往返时间RTT为100ms，报文段最大生存时间为60s。那么，所设计的协议头部中的窗口字段和序号字段最少应该有多少比特？为什么？ 

> 解答：窗口大小必须能够容纳的数据应该为RTT*带宽，而序号则应该保证不会回绕 造成具有相同序号的报文段在网络中同时传输，即序号大小至少为报文段最大生存时间*带宽。已知该网络的带宽为100Mb/s，线路的往返时间RTT为100ms，报文段最大生存时间为60s。则RTT*带宽 =100ms*100Mb/s=10Mb=10*106b，而223<10*106<224，这样窗口大小必须容纳 224/8=221B，即窗口字段最小应该为21B。而报文段最大生存时间*带宽=60s*100Mb/s =6000Mb=6*109b，232<10*109<233， 这样序号空间大小至少233/8=230，即序号字段最小应该为30b。

---

1. 对于以1Gb/s速率运行的网络，延迟（而不是带宽）成为主要的限制因素。现在假设有一个城域网，其源主机和目的主机平均距离为20km。试问数据传输速率为多大时，由于光速导致的往返时延RTT等于长为1KB的分组的发送时延？已知光在光纤和铜导线中的传播速度大约为每毫秒200km。 

  > 解答：光在光纤和铜导线中的传播速度大约为200km/ms，源主机和目的主机的线路 平均长度为20km，则单向传播时延=20/200=0.1（ms），往返传播时延=0.2ms。 假设数据传输速率为Rb/s，由于要求往返传播时延等于发送1KB的发送时  延，则有 100*8/R=0.2*10-3  求得，R=40（Mb/s）。因此，当数据传输速率为40Mb/s时，发送1KB的发送时延等于往返传播时延。

---

## xx

1．在IP地址为IP1的主机1上的一个进程被分配端口p，在IP地址为IP2的主机2上的一个进程被分配端口q，那么，在这两个端口之间是否可以同时建立两条或多条TCP连接？为什么？
答：不可以。一条连接仅仅用它的套接口标识.因此,(IP1,p)--(IP2,q)是在这两个端口之间惟一可能的连接。
2．假定TCP使用2次握手替代3次握手来建立连接，也就是说，不需要第3个报文。那么是否可能产生死锁？请举例来说明你的答案。
答：会产生死锁，第3次握手确认是为了避免第2次服务应答确信到达对方。若无此确认，意味着第2次服务应答丢失，客户端重发连接请求，服务方会误认为是新的连接请求，并同意连接请求，分配新的连接进程，这样反复就造成服务资源浪费，直至死锁。
3．TCP和UDP在传输报文时都使用端口号来标识目的实体。试说明为什么这两个协议使用一个新的抽象标识符（即端口号），而不使用进程号来标识。
答：用端口号代表不同套接字与进程对应，以区别用户端服务。
4．在一个1Gb/s的TCP连接上，发送窗口的大小为65535B，发送方和接收方的单程延迟时间为10ms。那么，可以获得的最大吞吐率是多少？线路效率是多少？
答：1000ms/20ms=50窗口，最大吞吐量=50*65535*8=26.214mb/s，
线路效率=26.214mbps/1000mbps=2.6%
5．假设需要设计一个类似于TCP的滑动窗口协议，该协议将运行于一个100Mb/s网络上，网络中线路的往返时间RTT为100ms，报文段最大生存时间为60s。那么，所设计的协议头部中的窗口字段和序号字段最少应该有多少比特？为什么？
答：窗口大小应能容纳的数据应该为RTT带宽，而序列号应保证不会回绕造成具有相同序号的报文在网上同时传输，即序号大小至少为报文段最大生存时间的带宽（60s*100mbps=6000mbps=6*109mbps），232<6*109<233，这样序号空间大小至少为233/8=230，即序号字段最小应为30bit，窗口大小：100ms*100mbps，223<10*106<224，
故窗口大小=224/8=221（21bit）
6．若一个应用进程使用传输层的用户数据报UDP。但继续向下交给IP层后，又封装成IP数据报。既然都是数据报，是否可以跳过UDP而直接交给IP层？UDP有没有提供IP没有提供的功能？
答：UDP提供端口号，而IP没有，IP不能取代UDP
7．使用TCP对实时话音业务的传输有没有什么问题？使用UDP在传送文件时会有什么问题
答：使用TCP传输实时话音时，对丢失和重传没有实际意义，使用UDP传输文件在可靠性上存在问题。
8．TCP在进行流量控制时是以分组的丢失作为产生拥塞的标志。有没有不是因拥塞而引起的分组丢失的情况？如有，请举出三种情况。
答：（1）分段时，其中某报文未及时达到终点，组装时因超时，只能丢弃报文。（2）报文达到终点，但无足够缓存而丢弃。（3）报文通过路由器转发时，无足够空间而丢弃。
9. 假设TCP拥塞控制算法中，慢开始ssthresh1的阈值初始设置为8，当拥塞窗口上升到12时，发送端检测出超时，TCP使用慢开始与拥塞避免。求第1次到第13次传输的拥塞窗口cwnd分别为多少？
答：
	

 

| n    | 1    | 2    | 3    | 4                | 5    | 6    | 7    | 8                 | 9    | 10   | 11   | 12               | 13   |
| ---- | ---- | ---- | ---- | ---------------- | ---- | ---- | ---- | ----------------- | ---- | ---- | ---- | ---------------- | ---- |
| cwnd | 1    | 2    | 4    | 8   进入避免拥塞 | 9    | 10   | 11   | 12   超时，慢启动 | 1    | 2    | 4    | 6   进入避免拥塞 | 7    |

1

9. 10.一个TCP连接总是以1KB的最大段发送TCP段，发送方有足够多的数据要发送。当拥塞窗口为16KB时发生了超时，如果接下来的4个RTT（往返时间）时间内的TCP段的传输都是成功的，那么当第4个RTT时间内发送的所有TCP段都得到肯定应答时，拥塞窗口大小是（C）
  答：发生超时时，下次的拥塞窗口值从1KB开始，门限值为16KB/2=8KB，然后进入慢开始阶段，每经历一个RTT，窗口值翻倍：2KB、4KB、8KB，此时到达门限值，进入拥塞避免阶段，窗口值每次增加1KB，因此，此时拥塞窗口值应该是9KB。
10. 主机A向主机B连续发送了两个TCP报文段，其序号分别为70和100。试问：
    （1）第一个报文段携带了多少个字节的数据？ 
    （2）主机B收到第一个报文段后发回的确认中的确认号应当是多少？ 
    （3）如果主机B收到第二个报文段后发回的确认中的确认号是180，试问A发送的第二个报文段中的数据有多少字节？ 
    （4）如果A发送的第一个报文段丢失了，但第二个报文段到达了B。B在第二个报文段到达后向A发送确认。试问这个确认号应为多少？
      答：（1）第一个报文段携带了100-70=30B
      （2）收到第一个报文段后发回的确认号是100
      （3）第二个报文段中的数据有180-100=80B
      （4）第一个报文段丢失后，确认号应为70
11. 主机A和主机B之间建立一个TCP连接，TCP最大段长度为1000字节，若主机A的当前拥塞窗口为4000字节，在主机A向主机B连续发送2个最大段后，成功收到主机B发送的第1段的确认段，确认段中通告的接收窗口大小为2000字节，则此时主机A还可以向主机B发送的最大字节数是多少？
    答：TCP发送窗口受拥塞窗口和接收窗口中的最小值限制，本题中，A收到的确认段中通告的接收窗口大小为2000字节，但发送方原来发送的2000中只有1000收到了确认，还要1000未收到确认，因此发送窗口向前滑动1000字节，发送方也只能再发1000字节。

## 第4章

习题
1．IP数据报中的首部检验和并不检验数据报中的数据。这样做的最大好处是什么？坏处是什么？
答：在首部中的错误比在数据中的错误更严重，例如，一个坏的地址可能导致分组被投寄到错误的主机。许多主机并不检查投递给他们的分组是否确实是要投递给它们，它们假定网络从来不会把本来是要前往另一主机的分组投递给它们。
    数据不参与检验和的计算，因为这样做代价大，上层协议通常也做这种检验工作，从前，从而引起重复和多余。
    因此，这样做可以加快分组的转发，但是数据部分出现差错时不能及早发现。
2．当某个路由器发现一数据报的检验和有差错时，为什么采取丢弃的办法而不是要求源站重发此数据报？计算首部检验和为什么不采用CRC检验码？
不采用CRC，简化解码计算量，提高路由器的吞吐量。
3．在Internet中分段传送的数据报在最后的目的主机进行组装。还可以有另一种做法，即通过了一个网络就进行一次组装。试比较这两种方法的优劣。
答：在目的站而不是在中间的路由器进行组装是由于：
（1）路由器处理数据报更简单些；效率高，延迟小。
（2）数据报的各分片可能经过各自的路径。因此在每一个中间的路由器进行组装可能总会缺少几个数据报片；
（3）也许分组后面还要经过一个网络，它还要给这些数据报片划分成更小的片。如果在中间的路由器进行组装就可能会组装多次。
4．现有一个公司需要创建内部的网络。该公司包括工程技术部、市场部、财务部和办公室四个部门，每个部门约有20-30台计算机。试问：
（1）若要将几个部门从网络上进行分开。如果分配该公司使用的地址为一个C类地址，网络地址为192.168.161.0，如何划分网络，将几个部门分开？
（2）确定各部门的地址和子网掩码，并写出分配给每个部门网络中的主机IP地址范围。
答：（1）第4个字节用3位做子网划分，满足划分6个子网的要求。子网掩码为：
    255.255.255.224
（2）各部门的子网范围：
	子网192.168.161.32的主机IP地址范围为：192.168.161.33~62
	子网192.168.161.64的主机IP地址范围为：192.168.161.65~94
	子网192.168.161.96的主机IP地址范围为：192.168.161.97~126
	子网192.168.161.128的主机IP地址范围为：192.168.161.129~158

5． 假设有两台主机，主机A的IP地址为208.17.16.165，主机B的IP地址为208.17.16.185，它们的子网掩码为255.255.255.224，默认网关为208.17.16.160。试问：
（1）主机A能否和主机B直接通信？
可以，因为A、B主机在同一子网
（2）主机B不能和IP地址为208.17.16.34的DNS服务器通信，为什么？
因为它们不在同一子网内
（3）如何制作一个修改就可以排除（2）中的故障？
修改网关地址为208.17.16.161
6．假设在以太网上运行IP协议，源主机A要和IP地址为192.168.1.250的主机B通信，请问A如何得到主机B的MAC地址？（说明采用的协议以及查找过程）
（1）主机A首先根据主机B的IP地址192.168.1.250，在自己的ARP高速缓存表查找与之对应的MAC地址。如果可以找到，不再进行地址解析；否则，则以广播方式发送一个ARP请求分组，该请求分组中包含主机A的IP地址、MAC地址以及主机B的主机地址。
（2）主机B在接收到ARP请求分组时，将完成地址解析，并发送ARP分组，该分组包含了主机B的MAC地址。
（3）主机A收到来自主机B的ARP应答分组时，将提取主机B的IP地址的MAC地址加入到ARP高速缓存表中，然后将具有完整的源IP地址、目的IP地址、目的MAC地址和数据作为一个发送分组，然后给数据链路层并封装成帧。

7．（1）假设一个主机的IP地址为192.55.12.120，子网掩码为255.255.255.240，给出其子网号、主机号以及直接的广播地址。（2）如果子网掩码是255.255.192.0，那么下列的哪些主机（A. 129.23.191.21、B. 129.23.127.222、C. 129.23.130.33、D. 129.23.148.122）必须通过路由器才能与主机129.23.144.16通信？
答：（1）子网号为0111（192.55.12.112） 主机号为1000（0.0.0.8） 直接的广播地址为192.55.12.127
（2）由子网掩码255.255.192.0可知这是一个B类网络，第三个字节的前两比特表示子网号。只需要把给出的各个主机的IP地址第三个字节转换成二进制，并分别与子网掩码进行二进制与操作，然后与目的主机相比较，如果子网号不相同，表示需要路由器进行转发。经过计算，给定主机的IP地址与A、C、D的IP地址进行与操作的结果均为10000000，只有B不同，为01000000，所以主机B与目的主机的通信必须通过路由器的转发。

8．已知某个C类网，现要将这个网分成几个子网，其中每个子网中的主机数不小于30，如何设计子网及子网掩码使其满足题目的要求？被分成多少子网？每个子网的可用IP地址数是多少？IP地址损失多少个？
答：每个子网的主机数不小于30，又因为每个子网不能使用全0和全1的地址，所以总的IP地址不少于32个，因为25=32。所以主机号为5比特。网络号为3比特。又因为全0和全1不能表示子网号，所以这里可以划分23-2=6个子网。子网掩码为255.255.255.224。每个子网的可用IP地址为30个。IP地址损失为28-6*30-2=74。

9．一个有50个路由器的网络，采用基于距离矢量的路由选择算法。路由表的每个表项长度为6个字节，每个路由器都有3个邻接路由器，每秒与每个邻接路由器交换一次路由表，则每条链路上由于路由器更新路由信息而耗费的带宽为多少？
答：在该网络上共有50个路由器，因此每个路由器的路由表大小为6*8*50=2400B,在基于距离矢量的路由选择算法中，每个路由器都定期地与所有相临地路由器交换整个路由表，并以此更新自己地路由表项。由于每个路由表每秒与自己的每个邻接路由表交换一次路由表，一条链路连接两个路由器，因此，每秒在一条链路上交换的数据为2*2400=4800B,即由于路由器更新路由信息而耗费的带框为4800B/s.

10．假设有一个IP数据报，头部长度为20B，数据部分长度为2000B。现该分组从源主机到目的主机需要经过两个网络。这两个网络所允许的最大传输单位MTU为1500B和576B。请问该数据报如何进行分片？
答：头部长为20B、数据部分长为2000B的IP数据包在经过MTU为1500B的第一个网络时进行分片，分为两片，分片1携带1480B的数据，分片2携带携带520B的数据。在经过MTU为576B的第二个网络时，分片1任然需要进一步分片，分为3个分片，分片3和分片4携带576B的数据，分片5携带368B的数据。因此，目的主机将收到四个分片，即分片3，分片4，分片5，分片6。

11．假设主机A要向主机B传输一个长度为512KB的报文，数据传输速率为50Mb/s，途中需要经过6个路由器，每条链路长度为1000Km。信号在链路中的传播速率为2000Km/s，并且链路是可靠的。假定对于报文与分组，每个路由器的排队延迟时间为1ms，数据传输速率以为50Mb/s，那么，在下列情况下，该报文需要多长时间才能到达主机B？
（1）采用报文交换方式，报文头部长为32B；
（2）采用分组交换方式，每个分组携带的数据位2KB，头部长为32B。
（1）采用报文交换方式，由于报文头部长为32B,报文携带的数据为512KB，因此，整个报文长为（32+512*1024）*8=4194560b。已知数据的传输速率为50Mb/s,则发送该报文所需的传输时延为4194560/50（us）=84ms。
	    另外，报文经过每个路由器的排队时延为1ms，在每条链路上的传播时延为1000/2000=0.5s=500ms。
		因此，该报文从主机A到主机B所需的总时间=7*传输时延+7*传播时延+6*排队时延=7*84+7*500+6 *1=4094ms.

（2）如果采用分组交换方式，由于分组头部长为32B，每个分组携带的数据为2KB，每个分组的总长度为（32+2*1024）*8=16640(b),分组的个数N为512/2=256。已知数据传输速率为50Mb/s,则发送该一个分组所需的传输时延为16640/50（us）=0.33ms.
	另外，每个分组经过每个路由器的排队时延为1ms,在每条链路上的传播时延为1000/2000=500ms.
	因此，从主机A到主机B发送的所有分组所需的总时间为主机A发送（N-1）个分组的传输时延加上最后一个分组从主机A到主机B的总时间，即等于（N-1）*传输时延+7*传输时延+7*传播时延+6*排队时延=（256-1）*0.33+7*0.33+7*500+6*1=3592.46ms。

---

## yy

1-02 简述分组交换的要点。
答：1）报文分组，加首部
    2）经路由器储存转发
3）在目的地合并

1-03 试从多个方面比较电路交换、报文交换和分组交换的主要优缺点。
答：
1）在效率上，报文交换和分组交换不需要预先分配传输带宽，在传突发性数据时可提高整个网络的信道利用率；而电路交换需要预先分配固定的带宽，没有数据传输的空隙，信道处于空闲，浪费资源。
2）在灵活性上，报文交换和分组交换可独立选择路由；而电路交换一旦连接建立，其传输路径是固定的，若线路受损，则通信断开。
3）在时延上，电路交换一旦连接建立后，后续数据的传输不需要在中间结点上停留，不存在处理时延，仅存在传播时延；而报文交换和分组交换虽然不需要连接建立的过程，但由于其采用存储-转发的方式，在中间结点要耗费一定的处理时延。
4）在可靠性上，分组交换具有完善的网络协议，分布式的多路由的分组交换网具有更好的生存性。
5）在适用性上，电路交换比较适用于信息量大、长报文，经常使用的固定用户之间的通信。报文交换适用于传输的报文较短、实时性要求较低的网络用户之间的通信，如公用电报网。分组交换适用于计算机类的突发性数据。
总的来说，分组交换比电路交换的电路利用率高，比报文交换的传输时延小，交互性好。

1-17  收发两端之间的传输距离为1000km，信号在媒体上的传播速率为2×108m/s。试计算以下两种情况的发送时延和传播时延： 
（1） 数据长度为107bit,数据发送速率为100kb/s。
（2） 数据长度为103bit,数据发送速率为1Gb/s。
从上面的计算中可以得到什么样的结论？
解：（1）发送时延：ts=107/105=100s
        传播时延tp=106/(2×108)=0.005s
   （2）发送时延ts =103/109=1µs
        传播时延：tp=106/(2×108)=0.005s
结论：若数据长度大而发送速率低，则在总的时延中，发送时延往往大于传播时延。但
若数据长度短而发送速率高，则传播时延就可能是总时延中的主要成分。

1-19  长度为100字节的应用层数据交给传输层传送，需加上20字节的TCP首部。再交给网络层传送，需加上20字节的IP首部。最后交给数据链路层的以太网传送，加上首部和尾部工18字节。试求数据的传输效率。数据的传输效率是指发送的应用层数据除以所发送的总数据（即应用数据加上各种首部和尾部的额外开销）。若应用层数据长度为1000字节，数据的传输效率是多少？
解：（1）100/（100+20+20+18）=63.3%
   （2）1000/（1000+20+20+18）=94.5%

1-24论述具有五层协议的网络体系结构的要点，包括各层的主要功能。
答：综合OSI 和TCP/IP 的优点，采用一种原理体系结构。各层的主要功能：
物理层 物理层的任务就是透明地传送比特流。（注意：传递信息的物理媒体，如双绞
线、同轴电缆、光缆等，是在物理层的下面，当做第0层。）物理层还要确定连接电
缆插头的定义及连接法。
数据链路层 数据链路层的任务是在两个相邻结点间的线路上无差错地传送以帧（frame
）为单位的数据。每一帧包括数据和必要的控制信息。
网络层 网络层的任务就是要选择合适的路由，使 发送站的运输层所传下来的分组能够
正确无误地按照地址找到目的站，并交付给目的站的运输层。
运输层 运输层的任务是向上一层的进行通信的两个进程之间提供一个可靠的端到端服务，使它们看不见运输层以下的数据通信的细节。
应用层 应用层直接为用户的应用进程提供服务。

2-16 共有4个站进行码分多址通信。4个站的码片序列为
A：（－1－1－1＋1＋1－1＋1＋1） B：（－1－1＋1－1＋1＋1＋1－1）
C：（－1＋1－1＋1＋1＋1－1－1） D：（－1＋1－1－1－1－1＋1－1）
现收到这样的码片序列S：（－1＋1－3＋1－1－3＋1＋1）。问哪个站发送数据了？发送数据的站发送的是0还是1？
解：S•A=（＋1－1＋3＋1－1＋3＋1＋1）／8=1，   A发送1
S•B=（＋1－1－3－1－1－3＋1－1）／8=－1， B发送0
S•C=（＋1＋1＋3＋1－1－3－1－1）／8=0，   C无发送
S•D=（＋1＋1＋3－1＋1＋3＋1－1）／8=1，   D发送1

3-07要发送的数据为1101011011。采用CRC的生成多项式是P（X）=X4+X+1。试求应添加在数据后面的余数。数据在传输过程中最后一个1变成了0，问接收端能否发现？若数据在传输过程中最后两个1都变成了0，问接收端能否发现？采用CRC检验后，数据链路层的传输是否就变成了可靠的传输？
答：作二进制除法，1101011011 0000 % 10011 得余数1110 ，添加的检验序列是1110.
作二进制除法，两种错误均可发现，仅仅采用了CRC检验，缺重传机制，数据链路层的传输还不是可靠的传输。

3-08要发送的数据为101110。采用CRCD 生成多项式是P（X）=X3+1。试求应添加在数据后面的余数。
答：作二进制除法，101110 000 % 1001 添加在数据后面的余数是011

3-18试说明10BASE-T中的“10”、“BASE”和“T”所代表的意思。
答：10BASE-T中的“10”表示信号在电缆上的传输速率为10MB/s，“BASE”表示电缆上
的信号是基带信号，“T”代表双绞线星形网，但10BASE-T的通信距离稍短，每个站到
集线器的距离不超过100m。

3-20假定1km长的CSMA/CD网络的数据率为1Gb/s。设信号在网络上的传播速率为200000km/s。求能够使用此协议的最短帧长。
答：对于1km电缆，单程传播时间为1/200000=5为微秒，来回路程传播时间为10微秒，
为了能够按照CSMA/CD工作，最小帧的发射时间不能小于10微秒，以Gb/s速率工作，10
微秒可以发送的比特数等于10*10-6*109=10000,因此，最短帧是10000位或1250字
节长

补充作业：
1.集线器和交换机各自的工作原理
集线器>-------集线器也叫Hub，工作在物理层（最底层），没有相匹配的软件系统，是纯硬件设备。集线器主要用来连接计算机等网络终端。 

集线器为共享式带宽，连接在集线器上的任何一个设备发送数据时，其他所有设备必须等待，此设备享有全部带宽，通讯完毕，再由其他设备使用带宽。正因此，集线器连接了一个冲突域的网络。所有设备相互交替使用，就好象大家一起过一根独木桥一样。 

集线器不能判断数据包的目的地和类型，所以如果是广播数据包也依然转发，而且所有设备发出数据以广播方式发送到每个接口，这样集线器也连接了一个广播域的网络。 

<交换机>-------交换机Switch，工作在数据链路层（第二层），稍微高端一点的交换机都有一个操作系统来支持。和集线器一样主要用于连接计算机等网络终端设备。 

交换机比集线器更加先进，允许连接在交换机上的设备并行通讯，好比高速公路上的汽车并行行使一般，设备间通讯不会再发生冲突，因此交换机打破了冲突域，交换机每个接口是一个冲突域，不会与其他接口发生通讯冲突。并且有系统的交换机可以记录MAC地址表，发送的数据不会再以广播方式发送到每个接口，而是直接到达目的接口，节省了接口带宽。
但是交换机和集线器一样不能判断广播数据包，会把广播发送到全部接口，所以交换机和集线器一样连接了一个广播域网络。高端一点的交换机不仅可以记录MAC地址表，还可以划分VLAN（虚拟局域网）来隔离广播，但是VLAN间也同样不能通讯。要使VLAN间能够通讯，必须有三层设备介入。 



2.集线器和交换机有什么区别？对冲突域和广播域有什么影响

以太网交换机和集线器的区别见下表：（仅作参考）

|                | 以太网交换机                                  | 集线器                           |
| -------------- | --------------------------------------------- | -------------------------------- |
| 所处层次       | 数据链路层                                    | 物理层                           |
| 转发方式       | 存储转发或直通方式                            | 直接转发                         |
| 工作原理       | 根据MAC帧中的目的MAC地址，查MAC表确定转发端口 | 收到一个比特就往其它所有端口转发 |
| 对冲突域的影响 | 可以分隔                                      | 不能分隔                         |
| 对广播域的影响 | 不能分隔，除非设置VLAN                        | 不能分隔                         |
| 连接的网络类型 | 可以连接不同类型、不同速率的LAN               | 只能连接相同类型、相同速率的LAN  |

 

集线器：纯硬件、用于连接网络终端、不能打破冲突域和广播域。 

交换机：拥有软件系统、用于连接网络终端、能够打破冲突域，但是不能分割广播域。

---

## 56

1. 概述
	1、	什么是协议？协议与服务有何区别？有何关系？

网络协议是有关计算机网络通信的一整套规则，由语法、语义、同步三部分构成。总的来说，协议是不同机器同等层次之间的通信协定。
服务是指下层为相邻的上层提供的功能调用。

区别：  协议是“水平的”，是不同机器同等层次之间的通信协定。但服务是“垂直的”，即服务是由下层通过层间接口向上层提供的。

联系：  协议保证了本层向上一层提供服务，而上一层的用户只能看见和使用本层的服务，本层的协议则对上一层进行隐藏。而要实现本层的协议，则需要下层所提供的服务。


2、	TCP/IP协议重要性体现在哪里？它与OSI的区别在哪里？

TCP/IP协议虽然不是ISO倡导的标准，但是它有着最为广泛的商业应用，已经成为了一种事实的标准。
区别：
TCP/IP是一种为了解决实际应用而开发出来的模型，其目的在于解决一系列特定的问题，得到了广泛应用。
而ISO则是对所有的网络通信做通用描述的一种模型，是一个标准化参考模型，在实际中并没有得到应用。
    当然它们的分层也不同，ISO分为7层，而TCP/IP只有4层。

2.

6. 电子邮件最主要的组成部件是什么？UA和MTA的作用是什么？能否不使用它们？
	有两个主要组成部件：用户接口（UA）和邮件传输协议（MTA）。
	UA： 是一个运行在本地的程序，主要提供三个功能：撰写信息，显示邮件（包括声音和图像），处理邮件（如打印、转发、分类保存等）。
	MTA：将邮件通过网络发送到对方主机，并从网络接收邮件。还有将邮件传送的情况（已交互、被拒绝、丢失等）向发信人报告。
	UA、MTA是电子邮件不可缺失的组成部分，无论缺失哪一个，都不能正常使用邮件服务。故不能不使用它们。


3. 传输层协议

2．假定TCP使用2次握手替代3次握手来建立连接，也就是说，不需要第3个确认报文。请问会产生什么情况？请举例来说明。
	可能会产生死锁。例子如下：
	有计算机A和B进行通信。假设B给Ａ发送了一个连接请求，Ａ接收了并发出确认应答报文。在两次握手成功的前提下，Ａ认为连接已经建立，可以开始发送数据，这时是完全正常的。
可是由于网络环境复杂，可能出现应答报文丢失的情况。 在Ａ的应答报文（第二次握手）丢失的情况下，Ｂ不知道Ａ到底有没有准备好，甚至Ｂ不知道它发送的连接请求到了A没有。在这种情况下，B会认为连接还未建立，忽略来自Ａ的任何数据（除了确认应答分组外）。而Ａ则认为连接已经建立成功，会开始发送数据，但发送的数据被B丢弃，从而产生数据超时，A再又重复发送，这样就形成了死锁。


4．在一个千兆网的TCP连接上，发送窗口的大小为65535B，发送方和接收方的单程延迟时间为10ms。请计算可以获得的最大吞吐率是多少？线路效率是多少？
	在一个RTT内能发送65535Bytes的数据，而一个RTT为2*10ms=20ms。
最大吞吐率=65535*8bit/(2*0.01s)=26214000bps
						     = 26.214Mbps

   线路效率 = 26.214Mbps/1000Mbps *100%  = 2.6214%

5．假设需要设计一个类似于TCP的滑动窗口协议，该协议将运行于一个百兆网络上，网络中线路的往返时间RTT为10ms，报文段最大生存时间为30s。那么，所设计的协议头部中的窗口字段和序号字段最少应该有多少比特？为什么？
窗口能容纳的数据应该为：RTT*带宽 = 10ms * 100Mbps = 1Mb = 1*10^6 b
而  2^19 < 1*10^6 < 2^20
窗口应该可以容纳2^20b = 2^17B，因此窗口字段最小应为17个比特。

序号应保证不会发生回绕，造成相同序号的报文段在网络中同时传输。
故序号最小为报文最大生存时间*带宽 = 30s * 100Mbps = 3000Mb = 3*10^9 b
而 2^31 < 3*10^9 < 2^32,
因此序号空间大小为2^32b = 2^29B，序号字段最小应为29个比特。

7．请解释为什么使用TCP实现实时的语音通话传输没有实际意义？而使用UDP在传送文件时会有什么问题？
TCP采用三次握手和错误重传机制来保证数据通讯的可靠性，但会增加数据延时。而对于实时的语音通话来说，数据的可靠性并不那么重要（丢失一点根本不影响意义的表达），但对实时性要求极高。所以使用TCP协议是将自己的优势变成了劣势。
UPD虽然传输快，但是没有差错控制，所以传输的数据可能有差错，对于一些要求可靠性的传输还是不要采用ＵＤＰ协议。。

8．TCP在进行流量控制时是以分组的丢失作为产生拥塞的标志，实际传输中还会发生不是因拥塞而引起的分组丢失情况。请举出三种分组丢失情况。

1. 如果IP数据报在传输过程中需要进行分段，但其中的一个数据报分段未能及时达到终点，终点组装IP数据报超时，因而只能丢弃该数据报。
2. IP数据报已经到达终点但终点的缓存没有足够的空间存放此数据报。
3. 数据报在转发过程中经过一个局域网的网桥，但网桥在转发该数据报帧的时候由于没有足够的差错空间而只好丢弃。

11. 主机A向主机B连续发送了两个TCP报文段，其序号分别为70和100。试问：
（1）第一个报文段携带了多少个字节的数据？ 
（2）主机B收到第一个报文段后发回的确认中的确认号应当是多少？ 
（3）如果主机B收到第二个报文段后发回的确认中的确认号是180，试问A发送的第二个报文段中的数据有多少字节？ 
（4）如果A发送的第一个报文段丢失了，但第二个报文段到达了B。B在第二个报文段到达后向A发送确认。试问这个确认号应为多少？
1. 30字节
2. 100
3. 80字节
4. 70



12. 主机A和主机B之间建立一个TCP连接，TCP最大段长度为1000字节，若主机A的当前拥塞窗口为4000字节，在主机A向主机B连续发送2个最大段后，成功收到主机B发送的第1段的确认段，确认段中通告的接收窗口大小为2000字节，则此时主机A还可以向主机B发送的最大字节数是多少？
1000字节
发送窗口 = min(接收窗口，拥塞窗口)
	发送窗口 = 已经发送但是未确认+还可以发送的大小











4。 网络层
2．当某个路由器发现一数据报的检验和有差错时，为什么采取丢弃的办法而不是要求源站重发此数据报？

如果采取“要求源站重发此数据报”的办法，有如下缺点：
1. 要求IP数据报分组头中的源IP地址没有出现差错，但校验和只针对分组头（20到60个字节），源IP地址占4个字节，源IP地址出错的几率并不小。
2. 需要由该路由器向源站发送相关的出错信息，以便源站能够重发数据，但是我们并不能保证有路由器发送的信息就能正确无误地到达源站。
3. 路由器向源站发送信息也会加剧网络的拥塞（如果源站发送的数据是由于网络拥塞而出现差错）。
采取丢弃的方法更加有效，将差错处理交给上层传输层协议进行处理。 



6．假设在以太网上运行IP协议，源主机A要和IP地址为192.168.1.250的主机B通信，请问A如何得到主机B的MAC地址？（说明采用的协议以及查找过程）

主机A采用ARP协议获取主机B的MAC地址。
源主机A首先在自己的高速缓存中查找是否有192.168.1.250的记录。如果有直接得到与192.168.1.250相关联的MAC地址。如果没有，进行以下操作：

1. 主机A请求获取目的节点的MAC地址：主机A以广播的方式在本地网络中发送一个ARP请求分组，其中包含源主机A的IP地址和MAC地址，以及目的主机B的IP地址。
2. 向发送请求物理地址的源主机A回送解析结果：在本网络中的所有主机都会接受到主机A发送的ARP请求分组，在接收到分组后，将ARP分组中的目的主机IP地址与本机的IP地址进行比较，如果相同，则产生一个包含自己物理地址的“ARP应答分组”，以单播的方式发回给请求主机A。否则丢弃分组。
3. 主机A收到来自主机B的ARP应答分组后，提取出主机B的IP地址和MAC 地址加入到ARP高速缓存表中。


9．一个有50个路由器的网络，采用基于距离矢量的路由选择算法。路由表的每个表项长度为6个字节，每个路由器都有3个邻接路由器，每秒与每个邻接路由器交换一次路由表，则每条链路上由于路由器更新路由信息而耗费的带宽为多少？

路由表的大小：50*6*8bit=2400bit。
在基于距离矢量路由选择算法中，每个路由器都定期地与所有相邻的路由器交换整个路由表，并以此更新自己的路由表项。由于每个路由器每秒与自己的每个邻接路由器交换1次路由表，一条链路连接两个路由器，因此，每秒在一条链路上交换的数据为2×2400=4800bit。 
因此，由于更新路由表而耗费的带宽为4800bit/s。


11．假设主机A要向主机B传输一个长度为512KB的报文，数据传输速率为50Mb/s，途中需要经过6个路由器，每条链路长度为1000Km。信号在链路中的传播速率为2000Km/s，并且链路是可靠的。假定对于报文与分组，每个路由器的排队延迟时间为1ms，数据传输速率以为50Mb/s，那么，在下列情况下，该报文需要多长时间才能到达主机B？
（1）采用报文交换方式，报文头部长为32B；
（2）采用分组交换方式，每个分组携带的数据位2KB，头部长为32B。

（1）整个报文大小为（32 + 512*1024）*8bit = 4194560bit。
1. 传输速率为50Mb/s，即50000b/ms，传输延时为4194560b / （50000b/ms） = 83.8912ms。2. 报文经过每条链路的传播延时为1000km /（2000km/s）= 0.5s = 500ms。
	3.每个路由器排队延时1ms。

总共经过6个路由器，7条链路。
综上，总共花费时间为：
传输延时*7 + 传播延时*7 + 排队延时*6 = 587.2384ms + 3500ms + 6ms = 4093.2384ms


（2）分组头为32B，分组携带数据2KB，每个分组大小为（32+2*1024）* 8b = 16640b。分组个数为512KB/2KB=256个。
1. 数据传输速率为50Mb/s，即50000b/ms，发送一个分组所需的传输延时为16640b / （50000b/ms） = 0.3328ms。
2. 在每条链路上的传播延时为1000km /（2000km/s）= 0.5s = 500ms
3. 每经过一个路由器的排队延时为1ms

256个数据报总共经过6个路由器，7条链路。
综上，总共时间为
传输延时*（256-1）+ 传输延时*7 + 传播延时*7  + 排队延时*6 = 0.3328ms*262 + 500ms*7 + 1ms*6 = 3593.1936ms


数据链路层
1．	信道速率为4kb/s。采用停止等待协议。传播时延tp＝20ms。确认帧长度和处理时间均可忽略。问帧长为多少才能使信道利用率达到至少50％？

帧传输效率 = tf/(tf + 2*tp)   tf 为数据帧发送延时，tp 为传播延时。
0.5 = tf/(tf + 2*20ms).

	tf = 40ms
因此，帧长最小为40ms * 4kb/s = 160b。

---

## 3

