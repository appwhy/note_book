# Linux知识点

[TOC]

<!-- toc -->

---

一个程序需要从外界获取输入，常见形式如下：

1. 配置文件
2. 环境变量
3. 命令行参数。三者风格：
   1. `param=value`
   2. `-字母 value` 
   3. `--字符串 value`
4. 交互式键盘输入



### Linux常用快捷键

* `Tab`：
  * 命令补全
  * 文件名或目录名补全
  * 连续按下两次`Tab`，显示以输入字符开头的所有命令。
* `Ctrl+d`：
  * 结束键盘输入
  * 让用户离开文字界面，相当于输入exit
  * 在命令行中向右删除，相当于按下Del键

* `Ctrl+c`：
  * 结束当前正在运行的程序
  * 取消当前命令行的编辑
* `Ctrl+l`：终端清屏，刷新屏幕
* `Ctrl+z`：将正在运行的程序送到后台。
* `Ctrl+r`：搜索历史命令
* `Ctrl+a`：移动光标到所在行的行首
* `Ctrl+e`：移动光标到所在行的行尾
* `Ctrl+u`：擦除从当前光标位置到行首的全部内容
* `Ctrl+k`：擦除从当前光标位置到行尾的全部内容
* `Ctrl+w`：擦除光标位置前的单词(以空格划分)；如果光标在一个单词本身上，它将擦除从光标位置到该单词词首的全部字母。
* `Ctrl+y`：粘贴使用 `Ctrl+w`，`Ctrl+u` 和 `Ctrl+k` 快捷键擦除的文本。

### shell执行命令流程

主要有以下前置工作：

* 文件名生成：

  * 遵循通配符规则，按照字典序排列。如`ls *.c`

  * 如果没有找到匹配文件，保持原文。如 

    ```bash
    ls *.c
    ls: cannot access *.c: No such file or directory
    ```

    

* 变量替换：如`ls $HOME`

* 命令替换：

  * 使用反引号将命令括起来。如`now='date'` （反引号不能显示，这里以单引号代替），以命令date的stdout替换date。
  * 使用`${}`：如 `now=${date}`，以命令date的标准输出替换${date}。

### bash

自动执行的一批命令（用户级别）：

* 当bash作为注册shell被启动时，会自动执行用户主目录下的 `~/.bash_profile` 文件中的命令。
* 当bash作为注册shell在退出时，会自动执行用户主目录下的 `~/.bash_logout` 。
* 当bash作为交互式shell启动时，会自动执行用户主目录下的 `~/.bashrc` 。

自动执行的一批命令（系统级别）：

- 当bash作为注册shell被启动时，会自动执行用户主目录下的 `/etc/profile` 文件中的命令。
- 当bash作为注册shell在退出时，会自动执行用户主目录下的 `/etc/logout` 。
- 当bash作为交互式shell启动时，会自动执行用户主目录下的 `/etc/bashrc` 。

### bash历史

历史记录表存储在 `~/.bash_history` .

如果想要修改历史记录表的大小，需要在 `~/.bashrc` 中修改 `HISTSIZE` 变量。

浏览历史命令：

* 直接使用上下方向键
* `!!`：引用上一命令
* `!str`：以str开头的最近用过的命令

### 别名

可以为linux命令定制别名（alias）：

* `alias rm='rm -i'`：新增别名。可以将其写入到`~/.bashrc`中。
* `alias`：查看别名表
* `unalias rm`：取消别名

### bash补全

Tab键：

* 每行的首个单词：可以补全搜索 `$PATH` 下的命令。
* 行中的其他单词：补全当前目录下的文件名。

### bash脚本

变量名：

* 第一个字符必须是字母、下划线
* 其余字符可以是字母、数字、下划线

变量赋值：`addr=172.31.3.1`。等号左右两边不能有空格。

引用变量：`$addr` 、`${addr}` 

引用未定义的变量，变量值为空字符串。

赋值时，如果等号右侧字符串中有特殊字符，如空格，需要将整个字符串使用双引号括起来。

shell内部开关：

* `set +u` 或 `set -u` ：使用加号时，如果引用了一个未被定义的变量，会被认为是空串（默认情况）。使用减号是，如果引用未定义变量，会产生一个错误。
* `set +x` 或 `set -x` ：减号表明，执行命令前打印出shell替换后变量后的命令及参数（为了区别正常输出，会在该打印前加上`+`）。加号则取消上述设置。

---

变量类型：

* 局部变量：所创建的shell变量，默认为局部变量。
* 环境变量：使用`export`命令可以将局部变量转为环境变量。常见环境变量：
  * LANG：语言选择
  * HOME：主目录 
  * TERM：终端 类型 
  * PATH：可执行文件的查找路径
  * CLASSPATH ：类库查找路径
  * CVSROOT：

shell启动的子进程会继承环境变量，不会继承局部变量。

子进程中对环境变量的修改，不影响父进程中的同名变量。

列出当前变量：

* `set`：内部命令，列出当前所有变量及其值，以及函数定义。
* `env`：外部命令，列出所有环境变量。

shell内部变量（位置参数）：

* `$0`：脚本文件本身的名字。
* `$1` / `$2`：1号命令参数，2号命令参数，以此类推
* `$#`：命令行参数的个数
* `"$*"`：等同于`"$1 $2 $3 ..."`
* `"$@"`：等同于 `"$1" "$2" "$3" ...`

内部命令：

* `shift`：位置参数的移位操作，`$#` 的值减一，旧的`$2` 变成 `$1`， 旧的 `$3` 变成 `$2`。
* `shift 3`：移动3位

---

### shell元字符

* 空格、制表符：命令行参数的分隔符
* 回车：执行键入的命令
* <>|：重定向与管道
* `;`：用于一行内输入多个命令
* `&`：后台运行
* `$`：引用shell变量
* 反向单引号：用于命令替换
* `*[]?`：文件通配符
* `\`：取消后继字符的特殊作用（转义）。如果反斜线加在非元字符前面，跟没有一样。
* `()`：用于定义shell函数，或在子shell中执行一组命令

` ()><|;&` 等除了它们自身的特殊含义外，还同时起到分隔符的作用 (同空格 )

元字符：

* 单引号：对所括起的任何字符，不作特殊解释。系统从扫描到单引号开始，停止对所有字符的特殊解释，直到再次遇到单引号。
* 双引号：除`$` 和反向单引号之外，其他特殊字符的特殊含义被取消

### xx

`printf '%s\n' $HOME` ： 要使用单引号。

`read name`：从用户输入中获取一行内容，赋值给变量name。







 







